# arkanoid

Курсовой проект по С++. Игра "Арканоид"

## Сборка

```
git clone https://github.com/krasnikovra/arkanoid
```

В качестве графического API использована библиотека SFML 2.5.1 32-bit (x86). Линковка SFML - динамическая. В корне есть скрипты копирующие все dll в нужную директорию после сборки, но VS генерирует их Read-Only. Поэтому при первой сборке может выдастся ошибка наподобие

```
1>C:\Program Files\Microsoft Visual Studio\2022\Community\MSBuild\Microsoft\VC\v170\Microsoft.CppCommon.targets(156,5): error MSB3073: выход из команды ".\dllscpy-d.bat
1>C:\Program Files\Microsoft Visual Studio\2022\Community\MSBuild\Microsoft\VC\v170\Microsoft.CppCommon.targets(156,5): error MSB3073: :VCEnd" с кодом 1.
```

Зайдите в свойства директории `Debug` (`Release`) и уберите флажок "Только для чтения". Тогда все dll будут автоматически копироваться скриптом.

## Задание

Арканоид.
Вверху поля множество прямоугольных блоков. Внизу горизонтально перемещается каретка. По полю летает «мяч», отражаясь от стен, блоков и каретки. Если мяч попадает вниз (мимо каретки) начисляются отрицательные очки /уменьшается каретка/увеличивается число поражений. Блоки бывают разных типов:

1)	Неразрушаемые. От них мяч просто отскакивает.
2)	Блоки могут быть со спрятанными бонусами: при попадании вертикально вниз падает бонус
3)	Блоки, увеличивающие скорость шарика при столкновении
4)	Блоки имеют уровень здоровья = число попаданий, чтобы блок исчез. За каждое попадание +1 очко игроку, -1 очко здоровья блоку.
5)	Бонусы: меняют размер каретки, меняют скорость шарика, меняют прилипание шарика к каретке. Бонус: одноразовое дно для шарика – можно один раз пропустить, дно сработает как каретка, и исчезнет. Бонус: шарик в произвольный момент меняет траекторию.
6)	Бонус: появляется двигающий блок, не задевающий при движении остальные блоки (надо проверять коллизии), и живущий до 3 ударов
7)	Бонус: появляется второй шарик, способный оттолкнуться и от первого, и от блоков/стенок

Для сдачи: 1-4 + любые 2 на выбор из 5/6/7

_Для сдачи выбраны пункты 1-4, 6, 7_

## Механика игры

### Основы

Вверху поля множество прямоугольных блоков. Внизу горизонтально перемещается каретка. По полю летает «мяч» (красный), отражаясь от стен, блоков и каретки. Если мяч падает вниз, то начисляется -15 очков. За каждое попадание по блоку (кроме неразрушаемых) даются очки, кол-во очков зависит от типа блоков.

### Блоки

Реализованы следующие типы блоков:

1) Неразрушаемые. От них мяч просто отскакивает.
2) Блок со спрятанным бонусом (голубой). После смерти из блока выпадает рандомный бонус. Выдерживает 1 удар, за попадание дает 15 очков.
3) Блок, увеличивающий скорость шарика (красный). После смерти увеличивает скорость шарика в 1.5 раза на 2 секунды. Если шарик ускорен и вновь разбивает этот блок, то происходит лишь обновление таймера ускорения - еще больше шарик не ускорится. Ускоренный шарик окрашивается в синий цвет. Выдерживает 1 удар, за попадание дает 15 очков.
4) Блок, имеющий уровень здоровья (зеленый). Просто разрушаемый блок. Выдерживает 2 удара, за попадание дает 10 очков.
5) Двигающийся блок (желтый). Блок, выпадающий только из бонуса, появляется в свободной ячейке и двигается по горизонтали отражаясь от блоков и краев окна. Выдерживает 3 удара, за попадание дает 30 очков.

Все блоки 2-5 могут иметь произвольный уровень здоровья, просто у некоторых он установлен равным единице. Изменение уровня здововья блока сопровождается установкой прозрачности (альфа-канала) прямо пропорциональной текущему уровню здоровья.

### Бонусы

Произвольный бонус выпадает при разрушении блока #2. Бонусы выглядят как маленькие прямоугольники медленно падающие вниз сквозь блоки/шарик. Чтобы взять бонус нужно попасть по нему кареткой. Всего есть 2 бонуса:

1) Бонус (фиолетовый) - дополнительный мяч. Создает новый дополнительный мяч (зеленый) в центре каретки. Дополнительный мяч при попадании вниз окна не отнимает очков (из тех соображений, что он бонусный, и игроку вредить ему не стоит), а просто умирает.
2) Бонус (оранжевый) - двигающийся блок. Создает в свободной ячейке (такая всегда есть, иначе бонус бы не выпал) блок #5.

### Шарик

Главный шарик - красный. Он умеет отражаться от границ окна и от блоков. От блоков отражается как шарик (не как квадрат), то есть с помощью столкновения шарика с углом прямоугольника первый может повернуть свою скорость на почти произвольный угол (внутрь блока он все-таки не полетит). 

Также шарик может сталкиваться с дополнительным шариком. Это происходит следующим образом: вектор соединяющий центры шариков объявляется осью, шарик изменяет проекцию своей скорости на эту ось на противоположную. Это не совсем реалистичная механика, поскольку ускоренный шарик, ударившись в медленный, не увеличит скорость последнего. Так сделано потому, что ускоренный шарик ускорен ограниченное время, а если он передаст свою скорость другому, то другой так и останется ускоренным. Это потенциально не устойчивая механика - так можно увеличиать скорость шарика до бесконечности.

### Каретка

Каретка отражает мяч почти как обычный блок. При попадании шарика в верхнюю грань каретки его скорость изменяется по-другому. Горизонтальная компонента скорости не сохраняется, а изменяется - вектор скорости поворачивается на угол прямо пропорциональный смещению шарика от центра каретки по горизонтали. Например, если шарик прилетел вертикально вниз в правую половину каретки, то он отскочит вверх и вправо. Так сделано потому, что в задании по этому поводу ничего особенного не сказано, а во всех арканоидах, что я видел, эта механика работает именно так.

Каретка управляется стрелками <- и -> на клавиатуре.
